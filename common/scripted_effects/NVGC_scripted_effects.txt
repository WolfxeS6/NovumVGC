increase_state_category_by_one_level = {
	if = {
		limit = { has_state_category = state_level_0 }
		set_state_category = state_level_1
	}
	else_if = {
		limit = { has_state_category = state_level_1 }
		set_state_category = state_level_2
	}
	else_if = {
		limit = { has_state_category = state_level_2 }
		set_state_category = state_level_3
	}
	else_if = {
		limit = { has_state_category = state_level_3 }
		set_state_category = state_level_4
	}
	else_if = {
		limit = { has_state_category = state_level_4 }
		set_state_category = state_level_5
	}
	else_if = {
		limit = { has_state_category = state_level_5 }
		set_state_category = state_level_6
	}
	else_if = {
		limit = { has_state_category = state_level_6 }
		set_state_category = state_level_7
	}
	else_if = {
		limit = { has_state_category = state_level_7 }
		set_state_category = state_level_8
	}
	else_if = {
		limit = { has_state_category = state_level_8 }
		set_state_category = state_level_9
	}
	else_if = {
		limit = { has_state_category = state_level_9 }
		set_state_category = state_level_10
	}
	else_if = {
		limit = { has_state_category = state_level_10 }
		set_state_category = state_level_11
	}
	else_if = {
		limit = { has_state_category = state_level_11 }
		set_state_category = state_level_12
	}
	else_if = {
		limit = { has_state_category = state_level_12 }
		set_state_category = state_level_13
	}
	else_if = {
		limit = { has_state_category = state_level_13 }
		set_state_category = state_level_14
	}
	else_if = {
		limit = { has_state_category = state_level_14 }
		set_state_category = state_level_15
	}
	else_if = {
		limit = { has_state_category = state_level_15 }
		set_state_category = state_level_16
	}
	else_if = {
		limit = { has_state_category = state_level_16 }
		set_state_category = state_level_17
	}
	else_if = {
		limit = { has_state_category = state_level_17 }
		set_state_category = state_level_18
	}
	else_if = {
		limit = { has_state_category = state_level_18 }
		set_state_category = state_level_19
	}
	else_if = {
		limit = { has_state_category = state_level_19 }
		set_state_category = state_level_20
	}
	else_if = {
		limit = { has_state_category = state_level_20 }
		set_state_category = state_level_21
	}
	else_if = {
		limit = { has_state_category = state_level_21 }
		set_state_category = state_level_22
	}
	else_if = {
		limit = { has_state_category = state_level_22 }
		set_state_category = state_level_23
	}
	else_if = {
		limit = { has_state_category = state_level_23 }
		set_state_category = state_level_24
	}
	else_if = {
		limit = { has_state_category = state_level_24 }
		set_state_category = state_level_25
	}
	else_if = {
		limit = { has_state_category = state_level_25 }
		set_state_category = state_level_26
	}
	else_if = {
		limit = { has_state_category = state_level_26 }
		set_state_category = state_level_27
	}
	else_if = {
		limit = { has_state_category = state_level_27 }
		set_state_category = state_level_28
	}
	else_if = {
		limit = { has_state_category = state_level_28 }
		set_state_category = state_level_29
	}
	else_if = {
		limit = { has_state_category = state_level_29 }
		set_state_category = state_level_30
	}
	else_if = {
		limit = { has_state_category = state_level_30 }
		set_state_category = state_level_31
	}
	else_if = {
		limit = { has_state_category = state_level_31 }
		set_state_category = state_level_32
	}
	else_if = {
		limit = { has_state_category = state_level_32 }
		set_state_category = state_level_33
	}
	else_if = {
		limit = { has_state_category = state_level_33 }
		set_state_category = state_level_34
	}
	else_if = {
		limit = { has_state_category = state_level_34 }
		set_state_category = state_level_35
	}
	else_if = {
		limit = { has_state_category = state_level_35 }
		set_state_category = state_level_36
	}
	else_if = {
		limit = { has_state_category = state_level_36 }
		set_state_category = state_level_37
	}
	else_if = {
		limit = { has_state_category = state_level_37 }
		set_state_category = state_level_38
	}
	else_if = {
		limit = { has_state_category = state_level_38 }
		set_state_category = state_level_39
	}
	else_if = {
		limit = { has_state_category = state_level_39 }
		set_state_category = state_level_40
	}
	else_if = {
		limit = { has_state_category = state_level_40 }
		add_extra_state_shared_building_slots = 1
	}
}
increase_state_category_by_two_levels = {
	if = {
		limit = { has_state_category = state_level_0 }
		set_state_category = state_level_2
	}
	else_if = {
		limit = { has_state_category = state_level_1 }
		set_state_category = state_level_3
	}
	else_if = {
		limit = { has_state_category = state_level_2 }
		set_state_category = state_level_4
	}
	else_if = {
		limit = { has_state_category = state_level_3 }
		set_state_category = state_level_5
	}
	else_if = {
		limit = { has_state_category = state_level_4 }
		set_state_category = state_level_6
	}
	else_if = {
		limit = { has_state_category = state_level_5 }
		set_state_category = state_level_7
	}
	else_if = {
		limit = { has_state_category = state_level_6 }
		set_state_category = state_level_8
	}
	else_if = {
		limit = { has_state_category = state_level_7 }
		set_state_category = state_level_9
	}
	else_if = {
		limit = { has_state_category = state_level_8 }
		set_state_category = state_level_10
	}
	else_if = {
		limit = { has_state_category = state_level_9 }
		set_state_category = state_level_11
	}
	else_if = {
		limit = { has_state_category = state_level_10 }
		set_state_category = state_level_12
	}
	else_if = {
		limit = { has_state_category = state_level_11 }
		set_state_category = state_level_13
	}
	else_if = {
		limit = { has_state_category = state_level_12 }
		set_state_category = state_level_14
	}
	else_if = {
		limit = { has_state_category = state_level_13 }
		set_state_category = state_level_15
	}
	else_if = {
		limit = { has_state_category = state_level_14 }
		set_state_category = state_level_16
	}
	else_if = {
		limit = { has_state_category = state_level_15 }
		set_state_category = state_level_17
	}
	else_if = {
		limit = { has_state_category = state_level_16 }
		set_state_category = state_level_18
	}
	else_if = {
		limit = { has_state_category = state_level_17 }
		set_state_category = state_level_19
	}
	else_if = {
		limit = { has_state_category = state_level_18 }
		set_state_category = state_level_20
	}
	else_if = {
		limit = { has_state_category = state_level_19 }
		set_state_category = state_level_21
	}
	else_if = {
		limit = { has_state_category = state_level_20 }
		set_state_category = state_level_22
	}
	else_if = {
		limit = { has_state_category = state_level_21 }
		set_state_category = state_level_23
	}
	else_if = {
		limit = { has_state_category = state_level_22 }
		set_state_category = state_level_24
	}
	else_if = {
		limit = { has_state_category = state_level_23 }
		set_state_category = state_level_25
	}
	else_if = {
		limit = { has_state_category = state_level_24 }
		set_state_category = state_level_26
	}
	else_if = {
		limit = { has_state_category = state_level_25 }
		set_state_category = state_level_27
	}
	else_if = {
		limit = { has_state_category = state_level_26 }
		set_state_category = state_level_28
	}
	else_if = {
		limit = { has_state_category = state_level_27 }
		set_state_category = state_level_29
	}
	else_if = {
		limit = { has_state_category = state_level_28 }
		set_state_category = state_level_30
	}
	else_if = {
		limit = { has_state_category = state_level_29 }
		set_state_category = state_level_31
	}
	else_if = {
		limit = { has_state_category = state_level_30 }
		set_state_category = state_level_32
	}
	else_if = {
		limit = { has_state_category = state_level_31 }
		set_state_category = state_level_33
	}
	else_if = {
		limit = { has_state_category = state_level_32 }
		set_state_category = state_level_34
	}
	else_if = {
		limit = { has_state_category = state_level_33 }
		set_state_category = state_level_35
	}
	else_if = {
		limit = { has_state_category = state_level_34 }
		set_state_category = state_level_36
	}
	else_if = {
		limit = { has_state_category = state_level_35 }
		set_state_category = state_level_37
	}
	else_if = {
		limit = { has_state_category = state_level_36 }
		set_state_category = state_level_38
	}
	else_if = {
		limit = { has_state_category = state_level_37 }
		set_state_category = state_level_39
	}
	else_if = {
		limit = { has_state_category = state_level_38 }
		set_state_category = state_level_40
	}
	else_if = {
		limit = { has_state_category = state_level_39 }
		set_state_category = state_level_40
		add_extra_state_shared_building_slots = 1
	}
	else_if = {
		limit = { has_state_category = state_level_40 }
		add_extra_state_shared_building_slots = 2
	}
}

add_research_slot_until_six = {
	if = {
		limit = { has_idea = idea_focus_generic_encouraged_private_research }
		modify_timed_idea = {
			idea = idea_focus_generic_encouraged_private_research
			days = 365
		}
	}
	else_if = {
		limit = { amount_research_slots > 5 }
		add_timed_idea = {
			idea = idea_focus_generic_encouraged_private_research
			days = 365
		}
	}
	else = {
		add_research_slot = 1
	}
}

add_one_random_civilian_factory = {
	if = {
		limit = { has_variable = building_index }
		meta_effect = {
			text = {
				random_owned_controlled_state = {
					prioritize = { [STATES] }
					limit = {
						OR = {
							is_core_of = owner
							is_claimed_by = owner
						}
						free_building_slots = { building = industrial_complex size > 0 include_locked = yes }
						is_valid_state_for_development = yes
						prefer_home_area_states_unless_filled = yes
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
			STATES = "[BC_Target_1] [BC_Target_2] [BC_Target_3] [BC_Target_4] [BC_Target_5] [BC_Target_6] [BC_Target_7] [BC_Target_8] [BC_Target_9] [BC_Target_10] [BC_Target_11] [BC_Target_12] [BC_Target_13] [BC_Target_14] [BC_Target_15]"
		}
	}
	else = {
		random_owned_controlled_state = {
			limit = {
				OR = {
					is_core_of = owner
					is_claimed_by = owner
				}
				free_building_slots = { building = industrial_complex size > 0 include_locked = yes }
				is_valid_state_for_development = yes
				prefer_home_area_states_unless_filled = yes
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
}

add_one_random_military_factory = {
	if = {
		limit = { has_variable = building_index }
		meta_effect = {
			text = {
				random_owned_controlled_state = {
					prioritize = { [STATES] }
					limit = {
						OR = {
							is_core_of = owner
							is_claimed_by = owner
						}
						free_building_slots = { building = arms_factory size > 0 include_locked = yes }
						is_valid_state_for_development = yes
						prefer_home_area_states_unless_filled = yes
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
				}
			}
			STATES = "[BC_Target_1] [BC_Target_2] [BC_Target_3] [BC_Target_4] [BC_Target_5] [BC_Target_6] [BC_Target_7] [BC_Target_8] [BC_Target_9] [BC_Target_10] [BC_Target_11] [BC_Target_12] [BC_Target_13] [BC_Target_14] [BC_Target_15]"
		}
	}
	else = {
		random_owned_controlled_state = {
			limit = {
				OR = {
					is_core_of = owner
					is_claimed_by = owner
				}
				free_building_slots = { building = arms_factory size > 0 include_locked = yes }
				is_valid_state_for_development = yes
				prefer_home_area_states_unless_filled = yes
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
	}
}

add_one_random_dockyard = {
	if = {
		limit = { has_variable = building_index }
		meta_effect = {
			text = {
				random_owned_controlled_state = {
					prioritize = { [STATES] }
					limit = {
						OR = {
							is_core_of = owner
							is_claimed_by = owner
						}
						free_building_slots = { building = dockyard size > 0 include_locked = yes }
						is_valid_state_for_development = yes
						prefer_home_area_states_unless_filled_dockyard = yes
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = dockyard
						level = 1
						instant_build = yes
					}
				}
			}
			STATES = "[BC_Target_1] [BC_Target_2] [BC_Target_3] [BC_Target_4] [BC_Target_5] [BC_Target_6] [BC_Target_7] [BC_Target_8] [BC_Target_9] [BC_Target_10] [BC_Target_11] [BC_Target_12] [BC_Target_13] [BC_Target_14] [BC_Target_15]"
		}
	}
	else = {
		random_owned_controlled_state = {
			limit = {
				OR = {
					is_core_of = owner
					is_claimed_by = owner
				}
				free_building_slots = { building = dockyard size > 0 include_locked = yes }
				is_valid_state_for_development = yes
				prefer_home_area_states_unless_filled_dockyard = yes
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
	}
}

add_one_random_synthetic_refinery = {
	if = {
		limit = { has_variable = building_index }
		meta_effect = {
			text = {
				random_owned_controlled_state = {
					prioritize = { [STATES] }
					limit = {
						OR = {
							is_core_of = owner
							is_claimed_by = owner
						}
						free_building_slots = { building = industrial_complex size > 0 include_locked = yes }
						is_valid_state_for_development = yes
						prefer_home_area_states_unless_filled = yes
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = synthetic_refinery
						level = 1
						instant_build = yes
					}
				}
			}
			STATES = "[BC_Target_1] [BC_Target_2] [BC_Target_3] [BC_Target_4] [BC_Target_5] [BC_Target_6] [BC_Target_7] [BC_Target_8] [BC_Target_9] [BC_Target_10] [BC_Target_11] [BC_Target_12] [BC_Target_13] [BC_Target_14] [BC_Target_15]"
		}
	}
	else = {
		random_owned_controlled_state = {
			limit = {
				OR = {
					is_core_of = owner
					is_claimed_by = owner
				}
				free_building_slots = { building = industrial_complex size > 0 include_locked = yes }
				is_valid_state_for_development = yes
				prefer_home_area_states_unless_filled = yes
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = synthetic_refinery
				level = 1
				instant_build = yes
			}
		}
	}
}

increase_ruling_party_fourth_estate = {
	if = {
		limit = {
			has_government = communist
		}
		fourth_estate_communist_increase = yes
	}
	else_if = {
		limit = {
			has_government = democratic_socialist
		}
		fourth_estate_democratic_socialist_increase = yes
	}
	else_if = {
		limit = {
			has_government = progressive
		}
		fourth_estate_progressive_increase = yes
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		fourth_estate_social_democrat_increase = yes
	}
	else_if = {
		limit = {
			has_government = social_liberal
		}
		fourth_estate_social_liberal_increase = yes
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		fourth_estate_market_liberal_increase = yes
	}
	else_if = {
		limit = {
			has_government = conservative
		}
		fourth_estate_conservative_increase = yes
	}
	else_if = {
		limit = {
			has_government = reactionary
		}
		fourth_estate_reactionary_increase = yes
	}
	else_if = {
		limit = {
			has_government = monarchist
		}
		fourth_estate_monarchist_increase = yes
	}
	else_if = {
		limit = {
			has_government = nationalist
		}
		fourth_estate_nationalist_increase = yes
	}
	else_if = {
		limit = {
			has_government = fascist
		}
		fourth_estate_fascist_increase = yes
	}
	else_if = {
		limit = {
			has_government = islamist
		}
		fourth_estate_islamist_increase = yes
	}
}

decrease_ruling_party_fourth_estate = {
	if = {
		limit = {
			has_government = communist
		}
		fourth_estate_communist_decrease = yes
	}
	else_if = {
		limit = {
			has_government = democratic_socialist
		}
		fourth_estate_democratic_socialist_decrease = yes
	}
	else_if = {
		limit = {
			has_government = progressive
		}
		fourth_estate_progressive_decrease = yes
	}
	else_if = {
		limit = {
			has_government = social_democrat
		}
		fourth_estate_social_democrat_decrease = yes
	}
	else_if = {
		limit = {
			has_government = social_liberal
		}
		fourth_estate_social_liberal_decrease = yes
	}
	else_if = {
		limit = {
			has_government = market_liberal
		}
		fourth_estate_market_liberal_decrease = yes
	}
	else_if = {
		limit = {
			has_government = conservative
		}
		fourth_estate_conservative_decrease = yes
	}
	else_if = {
		limit = {
			has_government = reactionary
		}
		fourth_estate_reactionary_decrease = yes
	}
	else_if = {
		limit = {
			has_government = monarchist
		}
		fourth_estate_monarchist_decrease = yes
	}
	else_if = {
		limit = {
			has_government = nationalist
		}
		fourth_estate_nationalist_decrease = yes
	}
	else_if = {
		limit = {
			has_government = fascist
		}
		fourth_estate_fascist_decrease = yes
	}
	else_if = {
		limit = {
			has_government = islamist
		}
		fourth_estate_islamist_decrease = yes
	}
}

clear_all_relations_with_TARGET = {
	if = {
		limit = { has_subject = var:target }
		set_autonomy = {
			target = var:target
			autonomy_state = autonomy_free
		}
		var:target = { leave_faction = yes }
	}
	else_if = {
		limit = { is_subject_of = var:target }
		overlord = {
			set_autonomy = {
				target = PREV
				autonomy_state = autonomy_free
			}
		}
		leave_faction = yes
	}
	else_if = {
		limit = { is_in_faction_with = var:target }
		leave_faction = yes
	}
	
	effect_tooltip = {
		every_other_country = {
			limit = {
				is_ally_with = var:target
				has_guaranteed = PREV
			}
			diplomatic_relation = {
				country = PREV
				relation = guarantee
				active = no
			}
		}
		every_other_country = {
			limit = {
				is_ally_with = var:target
				has_non_aggression_pact_with = PREV
			}
			diplomatic_relation = {
				country = PREV
				relation = non_aggression_pact
				active = no
			}
		}
		every_other_country = {
			limit = {
				is_ally_with = var:target
				has_military_access_to = PREV
			}
			diplomatic_relation = {
				country = PREV
				relation = military_access
				active = no
			}
		}
		every_other_country = {
			limit = {
				is_ally_with = var:target
				is_guaranteed_by = PREV
			}
			PREV = {
				diplomatic_relation = {
					country = PREV
					relation = guarantee
					active = no
				}
			}
		}
		every_other_country = {
			limit = {
				is_ally_with = var:target
				gives_military_access_to = PREV
			}
			PREV = {
				diplomatic_relation = {
					country = PREV
					relation = military_access
					active = no
				}
			}
		}
		every_other_country = {
			limit = {
				is_ally_with = var:target
				gives_military_access_to = PREV
			}
			PREV = {
				diplomatic_relation = {
					country = PREV
					relation = military_access
					active = no
				}
			}
		}
		if = {
			limit = { has_dlc_bba = yes }
			every_other_country = {
				limit = {
					is_ally_with = var:target
					is_embargoing = PREV
				}
				diplomatic_relation = {
					country = ROOT
					relation = embargo
					active = no
				}
			}
			every_other_country = {
				limit = {
					is_ally_with = var:target
					is_embargoed_by = PREV
				}
				PREV = {
					diplomatic_relation = {
						country = PREV
						relation = embargo
						active = no
					}
				}
			}
		}
		else = {
			every_other_country = {
				limit = {
					is_ally_with = var:target
					has_country_flag = embargoed_@PREV
				}
				remove_opinion_modifier = {
					modifier = embargo
					target = PREV
				}
			}
			every_other_country = {
				limit = {
					is_ally_with = var:target
					PREV = { has_country_flag = embargoed_@PREV }
				}
				PREV = {
					remove_opinion_modifier = {
						modifier = embargo
						target = PREV
					}
				}
			}
		}
	}
	hidden_effect = {
		every_other_country = {
			limit = { is_ally_with = var:target }
			diplomatic_relation = {
				country = PREV
				relation = guarantee
				active = no
			}
			diplomatic_relation = {
				country = PREV
				relation = non_aggression_pact
				active = no
			}
			diplomatic_relation = {
				country = PREV
				relation = military_access
				active = no
			}
			diplomatic_relation = {
				country = PREV
				relation = market_access_rights
				active = no
			}
			PREV = {
				diplomatic_relation = {
					country = PREV
					relation = guarantee
					active = no
				}
				diplomatic_relation = {
					country = PREV
					relation = military_access
					active = no
				}
			}
			clear_embargo_PREV = yes
		}
	}
}